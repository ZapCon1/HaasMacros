%
O09613 (REN TOOL BRK) 
(PROGRAM CENTER TOOLS G65 P9613) 
(CAN PROGRAM H IS TOLERANCE NO H GOES TO DEFAULT)
(NEGATIVE H CHECKS FOR PULLED TOOLS BY H VALUE)
(DOESN'T MEASURE TOOL OR RESET TOOL LENGTH) 
(PROGRAM I OR J TO MOVE OFF CENTER) 
G103 P1
M05 (STOP SPINDLE FROM ROTATING) 
M9 (COOLANT OFF)
M89 (TSC OFF)
G4 P5. (DWELL FOR TSC)
M08 (COOLANT ON )
#2= 0.2 (CLEARANCE ABOVE DISK IN RAPID) 
#6= 3. (COOLANT CLEARANCE)
IF [ #11 NE #0 ] GOTO10 
#11= 0.010 (DEFAULT TOL CHECK) 
N10
#1= 0 (NEGATIVE H INPUT FOR PULLED TOOL CHECK) 
IF [ #11 LT 0 ] #1=1.(CHECK FOR PULLED TOOLS BY H)
G28 G91 Z0 
G49
G90 
#174= 0 
M98 P9799 
G103 P1 
#27= #5021 - #5041 
#32= #5022 - #5042 
#33= #5023 - #5043 
#3004= 0 
G00 X [ #167 - #27 + #4 ] Y [ #168 - #32 + #5 ] 
G65 P9855 (OTS ON) 
G103 P1 
#28= #163 + #2 - #33  
IF [ #4 LT 0 ] S800 M04 
IF [ #5 LT 0 ] S800 M04 
IF [ #4 GT 0 ] S800 M04 
IF [ #5 GT 0 ] S800 M04 
G43 H#3026 Z[#28+#6]
M9 (COOLANT OFF)
G0 Z#28 (FINISH Z MOVE)
M98 P9799 
G103 P1 
IF [ #1 NE 1 ] GOTO240 
#27= #163 - #33 + #11 
G31 Z#27 F [ 500 * #29 ] 
IF [ ABS[ [ #5063 - #199 ] - #28 ] LT 0.05 * #29 ] GOTO24 (OPEN) 
IF [ ABS[ [ #5063 - #199 ] - #27 ] GT 0.05 * #29 ] GOTO34 (PULLED) 
N240 
#27= #163 - #33 - #11
#30=#5043(STORE POSITION)  
G31 Z#27 F [ 200 * #29 ] 
IF [ ABS[ #5043 - #30 ] LT 0.05 * #29 ] GOTO24 (OPEN)  
IF [ ABS[ [ #5063 - #199 ] - #27 ] LT 0.05 * #29 ] GOTO35 (BROKEN) 
GOTO27 
N24 
G91 G28 Z0 
G90 
#3000= 92 (PROBE OPEN) 
N34 
G91 G28 Z0 
G90 
#3000= 93 (TOOL PULLED) 
N35 
G91 G28 Z0 
G90 
#3000= 93 (BROKEN TOOL) 
N27 
G91 G28 Z0 
G90 
G65 P9856 (OTS OFF) 
M05 
G103 
M99 

%